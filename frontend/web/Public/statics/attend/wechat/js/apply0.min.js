$(function(f){var c=f("#approveCancel"),e=f("#approveSubmit"),a=f("#serverids"),b=0,d=f("#qjDiff");window.getRemainCallback=function(g){var h={date:f(g).data("val")};YI.getAjaxInfo({url:"/attend/approve/applytimes",data:h,method:"post",weui:true,fn:function(i){var i=i.data;if(i){d.children("div").html("申请期间漏打卡申请额度剩余："+i[1]+"次").end().css("display","block")}else{d.children("div").html("").end().css("display","none")}}})};c.on("click",function(){f.confirm(isCancel,function(){window.close();wx.closeWindow()},function(){})});e.on("click",function(){var j=f("input[name=approveid]").val(),m=f(".reason").val(),l=f("input[name=copy]").val(),g=a.val(),h=f(".approveDate").val(),i="";f(".arrivie").each(function(o,n){if(f(this).prop("checked")==true){i+="1"}else{i+="0"}});if(h==""){f.alert("请选择时间");return false}if(i=="0000"){f.alert("请选择异常类型");return false}if(m==""){f.alert("请填写异常说明");return false}if(j==""){f.alert("请选择审批人");return false}if(check_pic==1&&g==""){f.alert(check_pic_message);return false}var k={type_id:type_id,approveId:j,reason:m,arrive:i,date:f(".approveDate").data("val"),copyIds:l,type:0,ccIds:cc_staff_ids,picstrs:g,level:level};if(b==1){return false}b=1;YI.getAjaxInfo({url:"/attend/approve/apply",data:k,method:"post",tip:false,weui:true,fn:function(n){function o(){location.href="/attend/approve/applyprocess?applyid="+n.data.id}f.toast("申请成功");setTimeout(function(){o()},2000)},erro:function(n){b=0;f.alert(n.errmsg)}})});wx.ready(function(){f(".mui-action-back").on("click",function(){wx.closeWindow()})})});