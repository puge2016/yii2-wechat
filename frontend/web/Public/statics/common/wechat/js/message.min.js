(function(b){b("body").append("<style>body{background: #fff;}html,body{width: 100%;height: 100%;}body{background:#EBEBEB;}#wrapper{left: 10px;top: 10px;bottom: 70px;right: 10px;width: -moz-calc(100% - 20px);width: -webkit-calc(100% - 20px);width: calc(100% - 20px);box-sizing: border-box;}.approve-iscroll-content ul{position: relative;background:#EBEBEB;}#pullDown, #pullUp {border-bottom:0 none;border-top:0 none;background:#EBEBEB;}.message-wrap,#scroller,#wrapper{background:#EBEBEB;}</style>");
var a=["/Public/statics/common/wechat/plugins/iscrollProbe5Plug/js/iscroll-probe-5","/Public/statics/common/wechat/plugins/iscrollProbe5Plug/js/iscroll-probe-5Plug",];
require.config({jsVersion:modulejsVersion})("approveIscroll",a.join(","),function(){var i=b("#messageWrap"),d=b('<div id="wrapper" class="approveiscroll-content message-wrap"><div id="scroller"><div id="pullDown"><span class="pullDownIcon"></span><span class="pullDownLabel">上拉刷新</span></div><ul></ul><div id="pullUp"><span class="pullUpIcon"></span><span class="pullUpLabel">加载更多</span></div></div></div>');
i.append(d);var c=b("#wrapper"),g=c.find("ul"),e=b.trim(i.data("url")),f=0,h={init:function(){this.iScroll();this.ajaxInfo("append");},firstPage:1,module:b.trim(i.data("module")),ajaxInfo:function(j){var k=this;
YI.getAjaxInfo({url:e?e:"/wei/index/messageget",data:{module:this.module,page:this.firstPage},isLoading:false,fn:function(m){if(!m.data){m.data=[];}var m=m.data,l="";
b.each(m,function(o,p){l+="<li>";b.each(p,function(q,r){if(q==0){l+='<div class="date"><span>'+r.time+"</span></div>";}if(r.msg_type=="news"){l+='<div class="articl identical">';
l+='<a href="'+r.content.articles[0].url+'">';l+='<div class="cont">';l+="<dl>";l+="<dt>"+r.content.articles[0].title+"</dt>";l+="<dd><span>"+r.time+"</span></dd>";
l+="<dd>";if(r.content.articles[0].picurl&&r.content.articles[0].picurl.substring(8,10)!="mm"){l+='<img src="'+r.content.articles[0].picurl+'" />';}l+="<p>"+r.content.articles[0].description+"</p>";
l+="</dd>";l+="</dl>";l+='<p class="open">查看全文</p>';l+="</div>";l+="</a>";l+="</div>";}else{if(r.msg_type=="text"){l+='<div class="text identical">';l+='<img class="appimg" src="'+r.content.avatar+'" />';
l+='<div class="cont">';l+="<em></em>";l+="<p>"+r.content.content+"</p>";l+="</div>";l+="</div>";}}});l+="</li>";});if(j=="before"){var n=g.find("li").eq(0);
n[j](l);}else{g[j](l);}if(myScrollPlug){if(k.firstPage>1){setTimeout(function(){myScrollPlug.scrollToElement(n[0],0,null,null,true);},50);}myScrollPlug.refresh();
}}});},iScroll:function(){var k=this;function j(s,o,r,n){var u,p=b(o).find(".up-icon"),q=b(o).find(".down-icon");var t=b(o).height(),m=b(o).find(".scroller-content").children("ul").height(),l=b(o).find(".scroller-pullUp");
if(t>m){b(o).find(".scroller-content").css("min-height",t);}k["massageIscroll"+s]=u=new IScroll(o,{probeType:3,mouseWheel:true,click:true});u.on("scroll",function(){var z=this.y,x=this.maxScrollY-z,w=q.hasClass("reverse_icon"),v=p.hasClass("reverse_icon");
if(z>=40){!w&&q.addClass("reverse_icon");return"";}else{if(z<40&&z>0){w&&q.removeClass("reverse_icon");return"";}}if(x>=40){!v&&p.addClass("reverse_icon");
return"";}else{if(x<40&&x>=0){v&&p.removeClass("reverse_icon");return"";}}});u.on("slideDown",function(){if(this.y>40){if(r){r();}this.refresh();p.removeClass("reverse_icon");
}});u.on("slideUp",function(){if(this.maxScrollY-this.y>40){if(n){n();}this.refresh();p.removeClass("reverse_icon");}});}window.isScrollInit();window.pullDownAction=function(){f=myScrollPlug;
k.firstPage++;h.ajaxInfo("before");};window.pullUpAction=function(){k.firstPage=1;h.ajaxInfo("html");};myScrollPlug.y=-99999999;},bindEvent:function(){}};
b(function(){h.init();});});})(Zepto);