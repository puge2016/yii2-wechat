(function(e){var n={jsServer:"",jsMerge:true,jsCompress:true,jsVersion:null,jsCache:{},jsDefineObj:{},jsMergeObj:[],jsDebug:true};var t=function(){var t={each:function(e,n){var t=null,i=0,r=e.length,s=r===undefined||typeof e==="function";if(s){for(t in e){if(n.call(e[t],t,e[t])===false)break}}else{for(;i<r;){if(n.call(e[i],i,e[i++])===false)break}}return e},objectType:function(){var e=["String","Function","Array","Number","RegExp","Object"];this.each(e,function(e,n){t["is"+n]=function(e){return Object.prototype.toString.apply(e)=="[object "+n+"]"}})},extend:function(e,n,t){if(n&&typeof n==="object"){var i=this;i.each(n,function(n,r){if(e.hasOwnProperty(n)){if(i.isArray(e[n])){i.each(r,function(r,s){if(e[n].hasOwnProperty(r)){e[n][r]=i.extend(e[n][r],s,t)}else{e[n].push(s)}})}else{if(!t)e[n]=r}}else{e[n]=r}})}return e},checkJs:function(e,t){if(n.jsCache[t]===e){return true}else{n.jsCache[t]=e;return false}},createJs:function(e,t){if(!e)return false;var i=null;switch(t.length){case 2:i=t[1];break;case 3:i=t[2];break}if(this.checkJs(e,t[0])){if(this.isFunction(i))i()}else{var r=document.createElement("script");r.type="text/javascript";r.src=n.jsServer+"/f="+e;document.getElementsByTagName("head")[0].appendChild(r);this.loadJs(r,i)}},checkValue:function(e,t,i,r){t=n.jsMergeObj;i="id";var s=false;for(var c in t){if(t[c][0][i]===e)s=true}if(!s&&!r){this.catchError('未找到 "'+e+'" 的依赖关系，请检查你的配置信息\n\n源代码 g$("'+e+'")',1)}return s},loadJs:function(e,n){var t=this;if(e.readyState){e.onreadystatechange=function(){if(e.readyState==="loaded"||e.readyState==="complete"){e.onreadystatechange=null;if(t.isFunction(n))n()}}}else{e.onload=function(){if(t.isFunction(n))n();e.onload=null};e.onerror=function(){t.catchError("请求脚本文件出错： "+e.src+" 请检查文件路径",1);e.onerror=null}}},setConfig:function(e){if(e.define&&e.merge){var t=e.merge,i=[],r=n.jsMergeObj.length,s=this;if(r>0){s.each(n.jsMergeObj,function(e,n){s.each(t,function(e,t){if(n[0].id===t.id){var r='[{"id":"'+t.id+'",merge:[',c=t.merge.length;s.each(t.merge,function(e,n){r+='"'+n+'"';if(e<c-1)r+=","});r+="]}]";s.catchError("注入 "+r+" 失败，已存在依赖配置",1)}else{i.push([t])}})});n.jsMergeObj=n.jsMergeObj.concat(i)}else{s.each(t,function(e,t){n.jsMergeObj.push([t])})}s.extend(n.jsDefineObj,e.define,true)}},getConfig:function(){var e=arguments,t=n.jsMergeObj.length,i="",r=this;if(t>0){r.each(n.jsMergeObj,function(t,s){var c=s[0];if(c.id===e[0]){var o=c.merge,a=o.length;r.each(o,function(e,t){var s=n.jsDefineObj[t];if(s){s=(n.jsCompress?s+".min":s)+".js";i+=s+(e<a-1&&n.jsDefineObj[o[e+1]]?",":"")}else{r.catchError("调用依赖 “"+t+"” 失败，该依赖未在配置中声明",1)}})}})}if(i===""){return false}else{return i+"?v="+n.jsVersion}},define_key:function(e){var n=e[0];if(this.isObject(n)){this.setConfig(n)}else{this.checkValue(n)&&this.createJs(this.getConfig(n),e)}},define_key_fn:function(e){var n=e[0];if(this.isObject(n)){this.setConfig(n);this.isFunction(e[1])&&e[1]()}else if(this.isFunction(e[1])){this.checkValue(n)&&this.createJs(this.getConfig(n),e)}else{e=[e[0],e[1],null];this.define_key_path_fn(e)}},define_key_path_fn:function(e){var t=e[0];if(!this.checkValue(t,null,null,true)){var i=t+"js",r=e[1],s=r.split(","),c=[i];if(s.length){c=[];for(var o=0,a=s.length;o<a;o++){c.push(i+o);n.jsDefineObj[i+o]=s[o]}}else{n.jsDefineObj[i]=r}n.jsMergeObj.push([{id:t,merge:c}]);this.createJs(this.getConfig(t),e)}else{this.catchError('注入 "'+e[0]+'","'+e[1]+'" 失败，已存在依赖配置',1)}},getVersion:function(){if(!n.jsVersion){var e={},t=/(\w+)=(\w+)/gi,i=document.getElementsByTagName("script"),r=null;if(i&&i.length>0){r=i[i.length-1].src;r.replace(t,function(n,t,i){e[t]=i});if(e["v"]){n.jsVersion=e["v"]}}}},catchError:function(t,i){if(e.console&&e.console.log&&n.jsDebug){if(i){console.log("\n\n%c模块依赖异常\n\n","color:red;");console.log("\n\nlog：\n%c"+t+"\n\n","color:blue;")}else{console.log("\n\n%c模块加载异常\n\n","color:red;");console.log("\n\nlog：\n"+t+"\n\n")}}}};var i=arguments[0],r=function(){switch(i.length){case 1:t.define_key(i);break;case 2:t.define_key_fn(i);break;case 3:t.define_key_path_fn(i);break}},s=function(){this.auto=function(){t.getVersion()};this.init=function(){try{t.objectType();r()}catch(e){t.catchError(e)}}};return s};(new(t())).auto();e.require=function(){(new(t(arguments))).init()};e.require.config=function(e){for(var t in e){if(n.hasOwnProperty(t)&&t!=="jsCache"){n[t]=e[t]}}return this}})(window);