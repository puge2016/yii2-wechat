(function(a){a(function(){window.__appstoreid=0;var b=function(){var g=a(".oneMore"),d=a(".getOne"),f=a(".getMore"),e=0,c={init:function(){e=this.windowHeight();this.bindEvent();var h=this;window.renderContactList=function(j){var i="";a.each(a(".plug-select"),function(l,n){if(a(n).hasClass("selected")){var k=a(n).children("section").find("ul");if(a(n).hasClass("oneMore")||a(n).hasClass("getOne")){a.each(j,function(p,r){var q=false;i+='<li data-uid="'+r.uid+'"><img src="'+r.src+'" /><ins>'+r.name+"</ins><em></em></li>"});var m=k.find("li.add").clone(true);k.html(i).append(m);a(n).find('input[type="hidden"]').val(a(n).find("li").eq(0).data("uid"))}else{if(a(n).hasClass("getMore")){a.each(j,function(p,r){var q=false;a.each(k.children("li"),function(t,s){if(a(s).data("uid")==r.uid){q=true}});if(!q){i+='<li data-uid="'+r.uid+'"><img src="'+r.src+'" /><ins>'+r.name+"</ins><em></em><b></b><h6></h6></li>"}});var m=k.find("li.add").clone(true);var o=k.find("li.reduce").clone(true);k.find("li.add,li.reduce").remove();k.append(i).append(m).append(o);h.renderSendData();h.renderNumber(k[0]);h.bxSelectPlug()}}return false}})}},renderSendData:function(){a.each(f,function(i,k){var j=a(k).find("li").not(".add,.reduce"),h=[];a.each(j,function(l,m){h.push(a(m).data("uid"))});a(k).find('input[type="hidden"]').val(h.join(","))})},bxSelectPlug:function(){var h=a(".bx-plug-select");a.each(h,function(k,l){var j=a(l).find(".add").index();a(l).find("li").children("h6").show();a(l).find("li").not(".add,.reduce").css("margin-right","20px");a(l).find("li").eq(j-1).css("margin-right","5px");a(l).find("li").eq(j-1).children("h6").hide()})},sendInit:function(){var i=this,h=false;this.bxSelectPlug();this.renderSendData();f.delegate("li.reduce","click",function(){var k=a(this).siblings().children("em");if(a.trim(a(this).data("reduce"))=="true"){var j=a(this).parents("ul").find("li").not(".add,.reduce");a.each(j,function(l,m){if(!a(m).children("em").length){a(m).append("<em></em>")}})}if(!h){h=true;k.css({display:"block!important"})}else{h=false;k.css({display:"none!important"})}});f.delegate("li > em","click",function(){var j=a(this).parents("ul")[0];a(this).parents("li").remove();i.renderSendData();i.renderNumber(j);i.bxSelectPlug()})},renderNumber:function(h){var i=a(h).find("li").not(".add,.reduce");a.each(i,function(j,k){a(k).children("b").html(j+1)})},windowHeight:function(){return a("window").height()},openSelectLayer:function(){a(".plug-select").delegate("li.add","click",function(){window.__appstoreid=a(this).parents("ul").data("appstoreid");var h=a("#selectContainer");a(this).parents(".plug-select").addClass("selected").siblings().removeClass("selected");h.css({"min-height":a(document).height()+"px"}).show();window._scrollTopVal=a(window).scrollTop();a(window).scrollTop(0);window.YiSelect.init(a.trim(a(this).children("a").data("type")))})},bindEvent:function(){var h=this;a.each(g.find("ul"),function(j,l){var k=a.trim(a(l).data("ids"));if(!k){a(l).attr("data-select",1)}});a.each(g.find("ul"),function(k,m){var l=a.trim(a(m).data("ids")),j=a.trim(a(m).data("select"));if(l){a.ajax({url:"/address/staff/getstaffbyid",type:"get",data:{aid:_aid,id:l},dataType:"json",success:function(n){if(n.staff.length){var i="";a.each(n.staff,function(p,q){i+='<li data-uid="'+q.id+'"><img src="'+(q.we_avatar?q.we_avatar:"")+'" /><ins>'+q.we_name+"</ins><i></i></li>"});a(m).html(i);var o=g.children("section").find("li");o.on("click",function(){if(a(this).hasClass("select")){a(this).removeClass("select");a(this).parents("article.plug-select").find("input").val("")}else{var p=a(this).data("uid");a(this).addClass("select").siblings().removeClass("select");a(this).parents("article.plug-select").find("input").val(p)}});a.each(o,function(p,q){if(a(q).hasClass("select")){a(q).parents("article.plug-select").find("input").val(a(q).data("uid"))}});if(j==1){a(m).append('<li class="add"><span></span><a href="javascript:void(0)"></a></li>')}}else{if(!a(m).find("li.add").length){a(m).append('<li class="add"><span></span><a href="javascript:void(0)"></a></li>')}}}})}else{if(j==1){if(!a(m).find("li.add").length){a(m).append('<li class="add"><span></span><a href="javascript:void(0)"></a></li>')}}}});this.sendNoDelete();this.sendInit();this.openSelectLayer()},sendNoDelete:function(){var j=this,i=a(".getMore").find("ul"),h=i.length;a.each(i,function(k,n){var l=a.trim(a(n).data("ids")),m=a.trim(a(n).data("aid"));if(a(n).data("delete")!="1"){if(l){a.ajax({url:"/address/staff/getstaffbyid",type:"get",data:{aid:m||_aid,id:l},dataType:"json",success:function(p){if(p.staff.length){var o="";a.each(p.staff,function(s,t){o+='<li class="no-delete" data-uid="'+t.id+'"><img src="'+(t.we_avatar?t.we_avatar:"")+'"><ins>'+t.we_name+"</ins></li>"});var q=a(n).find("li.add").clone(true);var r=a(n).find("li.reduce").clone(true);a(n).find("li.add,li.reduce").remove();a(n).html(o).append(q).append(r)}if((k+1)==h){j.sendInit()}}})}}else{if(l){a.ajax({url:"/address/staff/getstaffbyid",type:"get",data:{aid:m||_aid,id:l},dataType:"json",success:function(p){if(p.staff.length){var o="";a.each(p.staff,function(s,t){o+='<li data-uid="'+t.id+'"><img src="'+(t.we_avatar?t.we_avatar:"")+'"><ins>'+t.we_name+"</ins><em></em><b>"+(s+1)+"</b><h6></h6></li>"});var q=a(n).find("li.add").clone(true);var r=a(n).find("li.reduce").clone(true);a(n).find("li.add,li.reduce").remove();a(n).html(o).append(q).append(r)}if((k+1)==h){j.sendInit()}}})}}})}};c.init()};b();window.selectUserInit=b})})(Zepto);